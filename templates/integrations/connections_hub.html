{% extends "base.html" %}
{% block title %}Connections Hub - StatementHub{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'review:dashboard' %}">Dashboard</a></li>
        <li class="breadcrumb-item active">Connections Hub</li>
    </ol>
</nav>

<div class="d-flex justify-content-between align-items-start mb-4">
    <div>
        <h4 class="mb-1"><i class="bi bi-plug"></i> Connections Hub</h4>
        <p class="text-muted mb-0">Manage your accounting platform connections. Connect once to access all client organisations.</p>
    </div>
</div>

<div class="row g-4">
    <!-- Xero -->
    <div class="col-lg-4">
        <div class="card h-100">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="mb-0"><i class="bi bi-cloud"></i> Xero</h6>
                {% if xero_conn and xero_conn.status == 'active' %}
                <span class="badge bg-success"><i class="bi bi-check-circle"></i> Connected</span>
                {% else %}
                <span class="badge bg-secondary">Not Connected</span>
                {% endif %}
            </div>
            <div class="card-body">
                {% if xero_conn and xero_conn.status == 'active' %}
                <p class="mb-2"><strong>{{ xero_tenant_count }}</strong> organisation(s) connected</p>
                <p class="text-muted small mb-3">Connected by {{ xero_conn.connected_by.get_full_name|default:"—" }}</p>
                {% elif xero_configured %}
                <p class="text-muted mb-3">Connect your Xero advisor account to access all client organisations.</p>
                {% else %}
                <p class="text-muted mb-3">Xero API credentials not configured. Set <code>XERO_CLIENT_ID</code> and <code>XERO_CLIENT_SECRET</code>.</p>
                {% endif %}
            </div>
            <div class="card-footer">
                <a href="{% url 'integrations:xero_global_dashboard' %}" class="btn btn-sm {% if xero_conn and xero_conn.status == 'active' %}btn-outline-primary{% elif xero_configured %}btn-primary{% else %}btn-outline-secondary disabled{% endif %} w-100">
                    {% if xero_conn and xero_conn.status == 'active' %}
                    <i class="bi bi-gear"></i> Manage
                    {% else %}
                    <i class="bi bi-cloud-arrow-down"></i> Connect
                    {% endif %}
                </a>
            </div>
        </div>
    </div>

    <!-- QuickBooks -->
    <div class="col-lg-4">
        <div class="card h-100">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="mb-0"><i class="bi bi-cloud"></i> QuickBooks Online</h6>
                {% if qb_conn and qb_conn.status == 'active' %}
                <span class="badge bg-success"><i class="bi bi-check-circle"></i> Connected</span>
                {% else %}
                <span class="badge bg-secondary">Not Connected</span>
                {% endif %}
            </div>
            <div class="card-body">
                {% if qb_conn and qb_conn.status == 'active' %}
                <p class="mb-2"><strong>{{ qb_tenant_count }}</strong> company(ies) connected</p>
                <p class="text-muted small mb-3">Connected by {{ qb_conn.connected_by.get_full_name|default:"—" }}</p>
                {% elif qb_configured %}
                <p class="text-muted mb-3">Connect your QuickBooks account to access client companies.</p>
                {% else %}
                <p class="text-muted mb-3">QuickBooks API credentials not configured. Set <code>QBO_CLIENT_ID</code> and <code>QBO_CLIENT_SECRET</code>.</p>
                {% endif %}
            </div>
            <div class="card-footer">
                <a href="{% url 'integrations:qb_global_dashboard' %}" class="btn btn-sm {% if qb_conn and qb_conn.status == 'active' %}btn-outline-primary{% elif qb_configured %}btn-primary{% else %}btn-outline-secondary disabled{% endif %} w-100">
                    {% if qb_conn and qb_conn.status == 'active' %}
                    <i class="bi bi-gear"></i> Manage
                    {% else %}
                    <i class="bi bi-cloud-arrow-down"></i> Connect
                    {% endif %}
                </a>
            </div>
        </div>
    </div>

    <!-- MYOB -->
    <div class="col-lg-4">
        <div class="card h-100">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="mb-0"><i class="bi bi-cloud"></i> MYOB</h6>
                {% if myob_conn and myob_conn.status == 'active' %}
                <span class="badge bg-success"><i class="bi bi-check-circle"></i> Connected</span>
                {% else %}
                <span class="badge bg-secondary">Not Connected</span>
                {% endif %}
            </div>
            <div class="card-body">
                {% if myob_conn and myob_conn.status == 'active' %}
                <p class="mb-2"><strong>{{ myob_file_count }}</strong> company file(s) connected</p>
                <p class="text-muted small mb-3">Connected by {{ myob_conn.connected_by.get_full_name|default:"—" }}</p>
                {% elif myob_configured %}
                <p class="text-muted mb-3">Connect your MYOB account to access client company files.</p>
                {% else %}
                <p class="text-muted mb-3">MYOB API credentials not configured. Set <code>MYOB_CLIENT_ID</code> and <code>MYOB_CLIENT_SECRET</code>.</p>
                {% endif %}
            </div>
            <div class="card-footer">
                <a href="{% url 'integrations:myob_global_dashboard' %}" class="btn btn-sm {% if myob_conn and myob_conn.status == 'active' %}btn-outline-primary{% elif myob_configured %}btn-primary{% else %}btn-outline-secondary disabled{% endif %} w-100">
                    {% if myob_conn and myob_conn.status == 'active' %}
                    <i class="bi bi-gear"></i> Manage
                    {% else %}
                    <i class="bi bi-cloud-arrow-down"></i> Connect
                    {% endif %}
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
